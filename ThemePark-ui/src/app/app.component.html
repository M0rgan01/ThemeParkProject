<!--NAVIGATION SANS NAVBAR-->

<div *ngIf="isHide" class="loginBackGround h-100">
  <div class="container">
    <router-outlet>
    </router-outlet>
  </div>
</div>


<!--BARRE DE NAVIGATION TOP-->
<nav *ngIf="!isHide" class="navbar navbar-dark fixed-top navbar-expand-lg border-bottom border-light nav-bg">

  <!--PARTIE GAUCHE-->

  <a class="navbar-brand ml-2 text-white cliquable p-0" routerLink="/home">
    <img src="../assets/img/logo.png" alt="Profile picture" class="logo">
    <span class="align-middle ml-2">{{title}}</span>
  </a>

  <button (click)="isToggledSideBar = !isToggledSideBar" type="button" class="btn mr-auto d-none d-lg-block"><span
    style="color: white"
    class="fa fa-bars fa-lg align-middle"></span></button>

  <button (click)="isToggledNavBar = !isToggledNavBar" type="button" class="btn d-lg-none">
    <span style="color: white" class="fa fa-bars fa-lg align-middle"></span>
  </button>

  <div class="collapse navbar-collapse" [ngbCollapse]="!isToggledNavBar">
    <ul class="navbar-nav">

      <li class="nav-item">
        <a class="nav-link text-white" routerLink="/park" (click)="isToggledNavBar = false">
          Les parcs
        </a>
      </li>


      <!-- CONTENU PETIT ECRAN -->
      <li class="nav-item dropdown d-md-block d-lg-none">
        <a class="nav-link dropdown-toggle" href="#" id="smallerscreenmenu" data-toggle="dropdown"
           aria-haspopup="true"
           aria-expanded="false">
          Mon compte
        </a>
        <div class="dropdown-menu" aria-labelledby="smallerscreenmenu">
          <div *ngIf="authService.isAuth()">
            <a class="dropdown-item" routerLink="/account">Mon profil</a>
            <a (click)="authService.signOut()"
               class="dropdown-item cliquable">Se déconnecter
            </a>
          </div>
          <div *ngIf="!authService.isAuth()">
            <a class="dropdown-item" routerLink="/login">Authentification</a>
            <a class="dropdown-item" routerLink="/register">Inscription</a>
          </div>
        </div>
      </li>
      <li *ngIf="authService.isAuth() && authService.isAdmin()" class="nav-item dropdown d-sm-block d-lg-none">
        <a class="nav-link dropdown-toggle" href="#" id="smallerscreenmenu2" data-toggle="dropdown"
           aria-haspopup="true"
           aria-expanded="false">
          Administration
        </a>
        <div class="dropdown-menu" aria-labelledby="smallerscreenmenu2">
          <a class="dropdown-item cliquable" routerLinkActive="active"
             [routerLink]="['/orders', 'admin']">Commande</a>
          <a class="dropdown-item cliquable" routerLinkActive="active" routerLink="/product/create">Produit</a>
          <a class="dropdown-item cliquable" routerLinkActive="active" routerLink="/category/create">Catégorie</a>
          <a class="dropdown-item cliquable" routerLinkActive="active" routerLink="/farmer/create">Agriculteur</a>
        </div>
      </li>

      <form class="form-inline d-sm-block d-lg-none">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">&#xF002;</div>
          </div>
          <input id="typeahead-http1" type="text" class="form-control" [class.is-invalid]="searchFailed"
                 [ngbTypeahead]="search"
                 [resultFormatter]="formatter" [inputFormatter]="formatter" [resultTemplate]="rt"
                 placeholder="Recherche"/>
        </div>
      </form>
      <!--FIN CONTENU PETIT ECRAN-->

    </ul>
  </div>


  <ng-template #rt let-r="result" let-t="term">
    <div (click)="submitSearch(r)">
      <img [src]="r.urlflag" class="mr-2" style="width: 16px" [alt]="r.name">
      <ngb-highlight [result]="r.name" [term]="t"></ngb-highlight>
    </div>
  </ng-template>

  <!--PARTIE DROITE-->

  <div class="navbar-collapse collapse">
    <ul class="navbar-nav ml-auto">
      <form class="form-inline">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">&#xF002;</div>
          </div>
          <input id="typeahead-http2" type="text" class="form-control" [class.is-invalid]="searchFailed"
                 [ngbTypeahead]="search"
                 [resultFormatter]="formatter" [inputFormatter]="formatter" [resultTemplate]="rt"
                 placeholder="Recherche"/>
        </div>
      </form>

      <li *ngIf="authService.isAuth()" class="nav-item dropdown ml-3">

        <a class="nav-link dropdown-toggle p-0 text-white cliquable" (click)="isCollapsedAccount = !isCollapsedAccount"
           [attr.aria-expanded]="isCollapsedAccount" aria-controls="collapse2">
          <img [src]="authService.getPhotoURL()" alt="Profile picture" class="img-rounded mx-2">
          <span class="align-middle">{{authService.getUserName()}}</span>
        </a>

        <div class="dropdown-menu ml-4" id="collapse2" [ngbCollapse]="!isCollapsedAccount">

        </div>

      </li>
    </ul>
  </div>
</nav>


<!-- SIDEBAR https://www.codeply.com/go/7XYosZ7VH5 -->
<div *ngIf="!isHide" class="row h-100 m-0 pt-5" id="body-row">
  <!-- Sidebar -->
  <div class="d-none d-lg-block col-2 p-0 border-right side-bar-bg"
       [ngClass]="{'d-lg-block': isToggledSideBar, 'd-lg-none': !isToggledSideBar}">

    <ul class="list-group sticky-offset sticky-top list-group-flush pt-5">

      <!-- <li class="list-group-item font-weight-bold mt-3" *ngIf="authService.isAuth()">
         Bonjour {{authService.getUserName()}}
       </li>-->

      <a routerLinkActive="font-weight-bold active-bg" routerLink="/home"
         class="list-group-item border-0 side-bar-bg"><i class="fas fa-home mr-2"></i>Accueil</a>

      <a *ngIf="!authService.isAuth()" routerLink="/login"
         class="list-group-item border-0 side-bar-bg"><i class="fas fa-lock mr-2"></i>Authentification</a>

      <!-- /END Separator -->
      <!-- Menu with submenu -->
      <a *ngIf="authService.isAuth()" (click)="isCollapsedAccount = !isCollapsedAccount"
         [attr.aria-expanded]="isCollapsedAccount" aria-controls="collapse1"
         class="side-bar-bg font-weight-bold list-group-item list-group-item-action flex-column align-items-start border-0">
        <div class="d-flex w-100 justify-content-start align-items-center">
          <span>Mon compte</span><span class="ml-2 dropdown-toggle"></span>
        </div>
      </a>

      <!-- Submenu content -->
      <div *ngIf="authService.isAuth()" id="collapse1" [ngbCollapse]="!isCollapsedAccount" class="collapse">
        <a routerLink="/account" class="list-group-item list-group-item-action text-white bg-dark">
          <span class="ml-2">Modifier mon compte</span>
        </a>
        <a routerLink="/orders" class="list-group-item list-group-item-action text-white bg-dark">
          <span class="ml-2">Mes commandes</span>
        </a>
        <a (click)="authService.signOut()"
           class="list-group-item list-group-item-action text-white bg-dark cliquable">
          <span class="ml-2">Se déconnecter</span>
        </a>
      </div>

      <a *ngIf="authService.isAuth() && authService.isAdmin()" (click)="isCollapsedAdmin = !isCollapsedAdmin"
         [attr.aria-expanded]="isCollapsedAccount" aria-controls="collapse3"
         class="side-bar-bg font-weight-bold list-group-item list-group-item-action flex-column align-items-start border-0">
        <div class="d-flex w-100 justify-content-start align-items-center">
          <span><i class="fas fa-tools mr-2"></i>Administration</span><span class="ml-2 dropdown-toggle"></span>
        </div>
      </a>
      <div *ngIf="authService.isAuth() && authService.isAdmin()" id="collapse3" [ngbCollapse]="!isCollapsedAdmin"
           class="collapse">

      </div>


      <a routerLinkActive="font-weight-bold active-bg" routerLink="/about"
         class="list-group-item list-group-item-action border-0 side-bar-bg"><i class="fas fa-info-circle mr-2"></i>À-propos</a>

    </ul>
    <!-- List Group END-->
  </div>
  <!-- sidebar-container END -->

  <div class="col">
    <div class="container">
      <div class="mb-5"></div>
      <router-outlet>
      </router-outlet>
    </div>
    <div class="mt-5"></div>
  </div>
</div>


